{"ast":null,"code":"import Vue from 'vue';\nimport VueRouter from 'vue-router';\nimport routes from \"./routes\";\nimport store from \"@/store\";\nimport { Loading, Message } from \"element-ui\";\nVue.use(VueRouter);\nconst router = new VueRouter({\n  routes\n});\n\n//全局前置守卫：登录态校验\nlet loadingIns;\nrouter.beforeEach(async (to, _, next) => {\n  let path = to.path,\n    profile = store.state.profile;\n  if (path !== '/login' && !profile) {\n    loadingIns = Loading.service({\n      text: \"努力加载中，请稍后......\",\n      background: \"rgba(0,0,0,.7)\"\n    });\n    profile = await store.dispatch('setProfileAsync');\n    if (!profile) {\n      Message.warning('您未登录，请登录！');\n      next(`/login?to=${path}`);\n      return;\n    }\n  }\n  next();\n});\n\n//全局后置守卫  :修改标题\nrouter.afterEach(to => {\n  if (loadingIns) loadingIns.close();\n  let {\n    title = \"\"\n  } = to.meta;\n  document.title = `新蜂CMS内容管理系统${title ? ` - ${title}` : ``}`;\n});\nexport default router;","map":{"version":3,"names":["Vue","VueRouter","routes","store","Loading","Message","use","router","loadingIns","beforeEach","to","_","next","path","profile","state","service","text","background","dispatch","warning","afterEach","close","title","meta","document"],"sources":["E:/北京珠峰练习/毕设/xinfeng-cms/src/router/index.js"],"sourcesContent":["import Vue from 'vue'\r\nimport VueRouter from 'vue-router'\r\nimport routes from \"./routes\"\r\nimport store from \"@/store\"\r\nimport { Loading, Message } from \"element-ui\"\r\n\r\nVue.use(VueRouter)\r\n\r\nconst router = new VueRouter({\r\n  routes\r\n})\r\n\r\n\r\n//全局前置守卫：登录态校验\r\nlet loadingIns;\r\nrouter.beforeEach(async (to, _, next) => {\r\n  let path = to.path,\r\n    profile = store.state.profile;\r\n  if (path !== '/login' && !profile) {\r\n    loadingIns = Loading.service({\r\n      text: \"努力加载中，请稍后......\",\r\n      background: \"rgba(0,0,0,.7)\"\r\n    })\r\n    profile = await store.dispatch('setProfileAsync');\r\n    if (!profile) {\r\n      Message.warning('您未登录，请登录！')\r\n      next(`/login?to=${path}`);\r\n      return;\r\n    }\r\n  }\r\n  next();\r\n});\r\n\r\n\r\n\r\n//全局后置守卫  :修改标题\r\nrouter.afterEach(to => {\r\n  if (loadingIns) loadingIns.close();\r\n  let { title = \"\" } = to.meta;\r\n  document.title = `新蜂CMS内容管理系统${title ? ` - ${title}` : ``}`;\r\n});\r\n\r\nexport default router\r\n"],"mappings":"AAAA,OAAOA,GAAG,MAAM,KAAK;AACrB,OAAOC,SAAS,MAAM,YAAY;AAClC,OAAOC,MAAM,MAAM,UAAU;AAC7B,OAAOC,KAAK,MAAM,SAAS;AAC3B,SAASC,OAAO,EAAEC,OAAO,QAAQ,YAAY;AAE7CL,GAAG,CAACM,GAAG,CAACL,SAAS,CAAC;AAElB,MAAMM,MAAM,GAAG,IAAIN,SAAS,CAAC;EAC3BC;AACF,CAAC,CAAC;;AAGF;AACA,IAAIM,UAAU;AACdD,MAAM,CAACE,UAAU,CAAC,OAAOC,EAAE,EAAEC,CAAC,EAAEC,IAAI,KAAK;EACvC,IAAIC,IAAI,GAAGH,EAAE,CAACG,IAAI;IAChBC,OAAO,GAAGX,KAAK,CAACY,KAAK,CAACD,OAAO;EAC/B,IAAID,IAAI,KAAK,QAAQ,IAAI,CAACC,OAAO,EAAE;IACjCN,UAAU,GAAGJ,OAAO,CAACY,OAAO,CAAC;MAC3BC,IAAI,EAAE,iBAAiB;MACvBC,UAAU,EAAE;IACd,CAAC,CAAC;IACFJ,OAAO,GAAG,MAAMX,KAAK,CAACgB,QAAQ,CAAC,iBAAiB,CAAC;IACjD,IAAI,CAACL,OAAO,EAAE;MACZT,OAAO,CAACe,OAAO,CAAC,WAAW,CAAC;MAC5BR,IAAI,CAAE,aAAYC,IAAK,EAAC,CAAC;MACzB;IACF;EACF;EACAD,IAAI,EAAE;AACR,CAAC,CAAC;;AAIF;AACAL,MAAM,CAACc,SAAS,CAACX,EAAE,IAAI;EACrB,IAAIF,UAAU,EAAEA,UAAU,CAACc,KAAK,EAAE;EAClC,IAAI;IAAEC,KAAK,GAAG;EAAG,CAAC,GAAGb,EAAE,CAACc,IAAI;EAC5BC,QAAQ,CAACF,KAAK,GAAI,cAAaA,KAAK,GAAI,MAAKA,KAAM,EAAC,GAAI,EAAE,EAAC;AAC7D,CAAC,CAAC;AAEF,eAAehB,MAAM"},"metadata":{},"sourceType":"module"}